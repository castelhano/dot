<div class="tab-pane fade show active col-lg-6" id="base" role="tabpanel">
  <div class="row g-1">
    <div class="form-floating mb-1 col-lg">
      {{ form.nome }}
      <label for="id_nome">Nome</label>
    </div>
  </div>
  <div class="row g-1">
      <div class="mb-1 col-lg">
        <select class="form-control" id="cargos_disponiveis" style="min-height:180px;" multiple>
          {% for funcao_fixa in funcoes_fixas %}
          <option value="{{funcao_fixa.id|safe}}">{{funcao_fixa.nome}}</option>
          {% endfor %}
        </select>
      </div>
      <div class="col-lg-auto">
        <div class="d-flex justify-content-center d-lg-grid gap-1">
          <a class="btn btn-sm btn-secondary pointer" id="select_multiple_add" onclick="addSelected();" style="padding-left: 11px;padding-right: 11px;"><i class="fas fa-angle-right rotate-lg-90"></i></a>
          <a class="btn btn-sm btn-secondary pointer" id="select_multiple_add_all" onclick="addAll();"><i class="fas fa-angle-double-right rotate-lg-90"></i></a>
          <a class="btn btn-sm btn-secondary pointer" id="select_multiple_remove" onclick="removeSelected();" style="padding-left: 11px;padding-right: 11px;"><i class="fas fa-angle-left rotate-lg-90"></i></a>
          <a class="btn btn-sm btn-secondary pointer" id="select_multiple_remove_all" onclick="removeAll();"><i class="fas fa-angle-double-left rotate-lg-90"></i></a>
        </div>
      </div>
      <div class="mb-1 col-lg">
        <select class="form-control" name="cargos" id="id_cargos" style="min-height:180px;" multiple></select>
      </div>
  </div>
</div>
<!-- CONTROLES DO FORM -->
<div class="row mt-3">
  <div class="col">
    <button type="submit" id="submit" class="btn btn-primary" title="ALT + G"><b>G</b>ravar</button>
  </div>
</div>

<script>
  // SET onsubmit="return submitForm();" ON FORM
  disponiveis = document.getElementById("cargos_disponiveis");
  selecionados = document.getElementById("id_cargos");
  function submitForm(){options = selecionados.options;for(i=0; i < options.length; i++){options[i].selected = "true";}document.getElementById('id_nome').disabled = false;return true;}
  function addAll(){selecionados.innerHTML += disponiveis.innerHTML;disponiveis.innerHTML = '';}
  function removeAll(){disponiveis.innerHTML += selecionados.innerHTML;selecionados.innerHTML = '';}
  function addSelected(){residual = document.createElement("select");for(var i=0; i < disponiveis.length; i++){if(disponiveis[i].selected){let newOption = new Option(disponiveis[i].text,disponiveis[i].value);selecionados.add(newOption);}else{let newOption = new Option(disponiveis[i].text,disponiveis[i].value);residual.add(newOption);}}disponiveis.innerHTML = residual.innerHTML;}
  function removeSelected(){residual = document.createElement("select");for(var i=0; i < selecionados.length; i++){if(selecionados[i].selected){let newOption = new Option(selecionados[i].text,selecionados[i].value);disponiveis.add(newOption);}else{let newOption = new Option(selecionados[i].text,selecionados[i].value);residual.add(newOption);}}selecionados.innerHTML = residual.innerHTML;}
  
  {% if 'funcao_fixa_add' in request.get_full_path %}
    funcao_fixa = 'new';
  {% else %}
    funcao_fixa = {{funcao_fixa.id|safe}};
    document.getElementById('id_nome').disabled = true;
    
    function cargosCadastrados() {
    	var xhttp = new XMLHttpRequest();
    	xhttp.onreadystatechange = function() {
    		if(this.readyState == 4 && this.status == 200){
    			if(this.responseText == ''){}
    			else{
    				let obj = JSON.parse(this.responseText);
    				let cadastrados = document.getElementById("id_cargos")
    				for(key in obj){cadastrados.innerHTML += '<option value="' + obj[key] + '">' + key + '</option>';}
    			}
    		}
    	};
    	xhttp.open("GET", "{% url 'pessoal_get_cargos_ff' %}?tipo=cadastrados&funcao_fixa=" + funcao_fixa, true);
    	xhttp.send();
    }
    cargosCadastrados();
  {% endif %}
    
  function cargosDisponiveis() {
  	var xhttp = new XMLHttpRequest();
  	xhttp.onreadystatechange = function() {
  		if(this.readyState == 4 && this.status == 200){
  			if(this.responseText == ''){}
  			else{
  				let obj = JSON.parse(this.responseText);
  				let disponiveis = document.getElementById("cargos_disponiveis")
  				for(key in obj){disponiveis.innerHTML += '<option value="' + obj[key] + '">' + key + '</option>';}
  			}
  		}
  	};
  	xhttp.open("GET", "{% url 'pessoal_get_cargos_ff' %}?tipo=disponiveis&funcao_fixa=" + funcao_fixa, true);
  	xhttp.send();
  }
  cargosDisponiveis();  
</script>